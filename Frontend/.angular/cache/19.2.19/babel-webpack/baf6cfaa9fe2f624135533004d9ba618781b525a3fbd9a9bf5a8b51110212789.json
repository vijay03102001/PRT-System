{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component, inject } from '@angular/core';\nimport { CommonModule, CurrencyPipe } from '@angular/common';\nimport { Validators, ReactiveFormsModule } from '@angular/forms';\nimport { HttpClient, HttpClientModule } from '@angular/common/http';\nimport { MatSnackBarModule } from '@angular/material/snack-bar';\nlet TimesheetsComponent = class TimesheetsComponent {\n  fb;\n  snackBar;\n  baseUrl = 'http://localhost:8080/api';\n  http = inject(HttpClient);\n  timesheetForm;\n  pendingTimesheets = [];\n  projects = [];\n  purchaseOrders = [];\n  resources = [];\n  isFrozen = false;\n  selectedResource = null;\n  constructor(fb, snackBar) {\n    this.fb = fb;\n    this.snackBar = snackBar;\n    this.timesheetForm = this.fb.group({\n      workDate: ['', Validators.required],\n      resourceId: ['', Validators.required],\n      projectId: ['', Validators.required],\n      poId: ['', Validators.required],\n      hoursWorked: [null, [Validators.required, Validators.min(0), Validators.max(24)]]\n    });\n    this.timesheetForm.get('resourceId')?.valueChanges.subscribe(resourceId => {\n      this.updateSelectedResource(resourceId);\n    });\n  }\n  ngOnInit() {\n    this.loadResources();\n    this.loadProjects();\n    this.loadPurchaseOrders();\n    this.loadPendingTimesheets();\n  }\n  loadResources() {\n    this.http.get(`${this.baseUrl}/resources`).subscribe({\n      next: data => this.resources = data,\n      error: () => this.showNotification('Failed to load resources', true)\n    });\n  }\n  updateSelectedResource(resourceId) {\n    this.selectedResource = this.resources.find(r => r.resourceId === resourceId) || null;\n  }\n  loadProjects() {\n    this.http.get(`${this.baseUrl}/projects`).subscribe({\n      next: data => this.projects = data,\n      error: () => this.showNotification('Failed to load projects', true)\n    });\n  }\n  loadPurchaseOrders() {\n    this.http.get(`${this.baseUrl}/pos`).subscribe({\n      next: data => this.purchaseOrders = data,\n      error: () => this.showNotification('Failed to load purchase orders', true)\n    });\n  }\n  loadPendingTimesheets() {\n    this.http.get(`${this.baseUrl}/timesheets`).subscribe({\n      next: data => this.pendingTimesheets = data,\n      error: () => this.showNotification('Failed to load pending timesheets', true)\n    });\n  }\n  onSubmit() {\n    if (this.timesheetForm.valid && !this.isFrozen && this.selectedResource) {\n      const formValue = this.timesheetForm.value;\n      const newTimesheet = {\n        resourceId: formValue.resourceId,\n        projectId: formValue.projectId,\n        poId: formValue.poId,\n        workDate: formValue.workDate,\n        hoursWorked: formValue.hoursWorked\n      };\n      this.http.post(`${this.baseUrl}/timesheets`, newTimesheet).subscribe({\n        next: response => {\n          this.pendingTimesheets.push(response);\n          this.timesheetForm.reset();\n          this.showNotification('Timesheet submitted successfully');\n        },\n        error: () => this.showNotification('Failed to submit timesheet', true)\n      });\n    }\n  }\n  approveTimesheet(id) {\n    this.http.put(`${this.baseUrl}/timesheets/${id}/approve`, {}).subscribe({\n      next: () => {\n        const timesheet = this.pendingTimesheets.find(t => t.timesheetId === id);\n        if (timesheet) {\n          timesheet.status = 'Approved';\n          this.showNotification('Timesheet approved successfully');\n        }\n      },\n      error: () => this.showNotification('Failed to approve timesheet', true)\n    });\n  }\n  rejectTimesheet(id) {\n    this.http.put(`${this.baseUrl}/timesheets/${id}/reject`, {}).subscribe({\n      next: () => {\n        const timesheet = this.pendingTimesheets.find(t => t.timesheetId === id);\n        if (timesheet) {\n          timesheet.status = 'Rejected';\n          this.showNotification('Timesheet rejected successfully');\n        }\n      },\n      error: () => this.showNotification('Failed to reject timesheet', true)\n    });\n  }\n  toggleFreeze() {\n    this.isFrozen = !this.isFrozen;\n    this.showNotification(this.isFrozen ? 'Timesheet submissions are now frozen' : 'Timesheet submissions are now enabled');\n  }\n  showNotification(message, isError = false) {\n    this.snackBar.open(message, 'Close', {\n      duration: 3000,\n      horizontalPosition: 'right',\n      verticalPosition: 'top',\n      panelClass: isError ? ['error-snackbar'] : ['success-snackbar']\n    });\n  }\n};\nTimesheetsComponent = __decorate([Component({\n  selector: 'app-timesheets',\n  standalone: true,\n  imports: [CommonModule, ReactiveFormsModule, MatSnackBarModule, HttpClientModule],\n  providers: [CurrencyPipe],\n  templateUrl: './timesheets.component.html',\n  styleUrls: ['./timesheets.component.css']\n})], TimesheetsComponent);\nexport { TimesheetsComponent };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}